---
title: "Take-home Exercise 01"
author: "Li Ziyi"
date: "Report Last Run: `r Sys.time()`"
---

## 1. Introduction

In this exercise, the basic demographic structure of Singapore top 9 biggest planning areas categorised by gender and age group is being studied.

Data used is extracted from [Department of Statistics, Singapore](https://www.singstat.gov.sg/find-data/search-by-theme/population/geographic-distribution/latest-data). The population data snapshot from June 2022 is being studied mainly.

## 2. Data Preparation

Inside the downloaded excel file, there are "Total" elements inside all columns. To load into Tableau for visualization and therefore, for better analysis purpose, we will need to do some basic data cleaning.

```{r}
#| echo: false
library(knitr)

```

### Data Cleaning

With the raw excel file not to be touched, a new Excel document is created to consolidate all needed raw data with the same table headers pasted over.

Given that planning area level data are to be studied, "Total Planning Area" and "Total Male and Female" data are removed as they are now redundant. If needed, total could be easily computed inside Tableau by summing up all the rest data.

Both male and female data are copied and consolidated into our new Excel files. A new column "Gender" is introduced. All data entries pasted are tagged accordingly based on the raw data.

Save the Excel data file and rename it properly.

```{r fig.align = 'center', fig.cap = "Excel data prepared", fig.cap.align = 'center', echo=FALSE}
include_graphics("G:/My Drive/SMU MITB/ISSS608 Visual Analytics and Applications/lzy66666666/Visual-Analytics-Applications/Take-home_Ex/Ex01/Img/Excel_data.PNG")
```

### Data Loading

Open a new Tableau workbook and import data using the Excel file.

For easier data manipulation later on, switch the data type of '2022' to integer from text (highlighted in yellow).

```{r fig.align = 'center', fig.cap = "Tableau data loading", fig.cap.align = 'center', echo = FALSE}
include_graphics("G:/My Drive/SMU MITB/ISSS608 Visual Analytics and Applications/lzy66666666/Visual-Analytics-Applications/Take-home_Ex/Ex01/Img/Tableau_data_loading.PNG")
```

## 3. Data Visualisation

Age-sex pyramid was taught be an analytical visualisation commonly used by demographers to reveal the structure of population by gender and age group.

### Overall Singaporean Population Pyramid

Two calculated fields are created to facilitate the visualisation preparation:

``` {{r}}
# | output: asis
Male:
if [Gender]="MALE"
then [2022]
END

Female:
if [Gender]="MALE"
then [2022]
END
```

To produce the desired visualisation, follow below steps:

-   Drag the 'Age Group' from Data panel into Filters section, select 'All' and de-select 'Total' option at the bottom of the list.

-   Drag the 'Subzone' from Data panel into Filters section, select 'All' and de-select 'Total' option inside the list.

-   Drag the 'Type of Dwelling' from Data panel into Filters section, select 'Total' option at the bottom of the list.

-   Drag the two created measures from Data panel into columns bar.

-   Drag the 'Age Group' from Data panel into rows bar.

-   Sort the 'Age Group' by clicking the white downwards pointing arrow, choose 'Sort' and sort by 'Alphabetic' in descending order.

-   Drag the line '5-9' inside the worksheet from 'Age Group' column to one line above '0-4'. With this, the age group should have been sorted in a descending manner entirely.

-   Drag the 'Female' from Data panel into Marks section 'Color'. Choose a color that you would like to assign to Female population data. Here, color pink is used.

-   Drag the 'Male' from Data panel into Marks section 'Color', Choose a color that you would like to assign to Male population data. Here, color blue is used.

Therefore, a population pyramid of Singapore has been completed. See below.

```{r fig.align = 'center', fig.cap = "Population pyramid of Singapore", fig.cap.align = "center", echo = FALSE}
include_graphics("G:/My Drive/SMU MITB/ISSS608 Visual Analytics and Applications/lzy66666666/Visual-Analytics-Applications/Take-home_Ex/Ex01/Img/SG_Pyramid.png")
```

### Selection of Nine Planning Areas

The task requested nine planning areas to be presented on a single view.

To find out areas to work on, it's more of my interest to filter based on total population. Below are actions that I have taken to achieve that.

-   Drag the '2022' values from Data panel into columns bar.

-   Drag the 'Planning Area' text from Data panel into rows bar.

-   Drag the 'Age Group' item from Data panel into Filters section, select 'Total'.

-   Drag the 'Subzone' item from Data panel into Filters section, select 'Total'.

-   Drag the 'Type of Dwelling' item from Data panel into Filters section, select 'Total'.

-   Drag the 'Gender' item from Data panel into Filters section, select 'TOTAL'.

-   Sort the 'Planning' by clicking the white downwards pointing arrow, choose 'Sort' and sort by 'Field' in descending order. Choose the field to be sorted with to be '2022' from the drop-down list. The aggregation we use here remains 'Sum'.

This would enable us to visualise the top few planning areas according to total area population. However, to make the list of top area more clearly, additional calculated fields 'Labels' and 'Top N Planning Area' were created, together with an additional parameter 'Top Planning Areas'. Since this is not compulsory step to achieve the requirement, I will not go into step by step details on this part. If interested, you may find workings inside the workbook attached.

Hence, below chart is completed.

```{r fig.align = 'center', fig.cap = "Top 9 planning area by total population", fig.cap.align = "center", echo = FALSE}
include_graphics("G:/My Drive/SMU MITB/ISSS608 Visual Analytics and Applications/lzy66666666/Visual-Analytics-Applications/Take-home_Ex/Ex01/Img/Total_top_9.png")
```

From here, the 9 areas that is being chosen to study on are Bedok, Tampines, Jurong West, Sengkang, Woodlands, Hougang, Yishun, Choa Chu Kang and Punggol. For the analysis purpose later, a population pyramind of these chosen 9 areas are also plotted by following above Overall Singaporean Poppulation Pyramid steps, with an additional step of dragging 'Planning Area' data item from Data panel into Filters section, the nine chosen areas are therefore selected.

```{r fig.align = 'center', fig.cap = "Top 9 planning area population pyramid", fig.cap.align = "center", echo = FALSE}
include_graphics("G:/My Drive/SMU MITB/ISSS608 Visual Analytics and Applications/lzy66666666/Visual-Analytics-Applications/Take-home_Ex/Ex01/Img/SG_top9areas_Pyramid.png")
```

### Trellis Display of Population Pyramid of The Nine Planning Areas

In this exercise, the nine planning areas are requested to be presented on a single view. To do that, a trellis display will be applied. Following below steps that will lead us to the desired output.

-   Duplicate the worksheet 'Population Pyramid_Top_9\_Area_SG_2022'.

-   Rename the worksheet to 'Trellis_Population Pyramid_Top_9\_Area_SG_2022'.

-   Drag the 'Planning Area' text from Data panel into rows bar.

The trellis display is therefore completed.

```{r fig.align = 'center', fig.cap = "Top 9 planning area population pyramid", fig.cap.align = "center", echo = FALSE}
include_graphics("G:/My Drive/SMU MITB/ISSS608 Visual Analytics and Applications/lzy66666666/Visual-Analytics-Applications/Take-home_Ex/Ex01/Img/SG_top9areas_Trellis.png")
```

### Final Dashboard

The final dashboard is produced by putting together some significant worksheets. Here, three worksheets have been chosen to present together to complete the whole story.

```{r fig.align = 'center', fig.cap = "Top 9 planning area population pyramid", fig.cap.align = "center", echo = FALSE}
include_graphics("G:/My Drive/SMU MITB/ISSS608 Visual Analytics and Applications/lzy66666666/Visual-Analytics-Applications/Take-home_Ex/Ex01/Img/Final_dashboard.png")
```

## 4. Observation and Insights (not more than 500 words)

### i. "Constrictive" pyramid (or "negative growth pyramid")

The type of population pyramid of Singapore

### ii. The population pyramid of Singapore from 2022 remains like the one from 2017.

### iii. Females outnumber males in Singapore Based on June 2022 data. 

This trend is observed in majority age groups. Zooming into each group, only for age 19 and below, number of males is observed to be higher. This is interesting.
